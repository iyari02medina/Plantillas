{% extends 'base.html' %}

{% block content %}
<div class="content">
    <div class="header-section">
        <div>
            <h1>{{ 'Clientes' if tipo == 'clientes' else 'Prospectos' }}</h1>
            <p class="subtitle">Gestión de {{ tipo }}.</p>
        </div>
        <div class="flex gap-2">
            <a href="{{ url_for('nuevo_directorio_item', tipo=tipo) }}" class="btn btn-primary">+ Nuevo {{ 'Cliente' if
                tipo == 'clientes' else 'Prospecto' }}</a>
            <a href="{{ url_for('directorio') }}" class="btn btn-secondary">Volver al Directorio</a>
        </div>
    </div>
</div>

<div class="card table-container">
    <h3>Listado de {{ 'Clientes' if tipo == 'clientes' else 'Prospectos' }}</h3>
    <table>
        <thead>
            <tr>
                {% for header in headers %}
                <th>{{ header|replace('_', ' ')|upper }}</th>
                {% endfor %}
                <th class="center">ACCIONES</th>
            </tr>
        </thead>
        <tbody>
            {% for row in data %}
            <tr>
                {% for header in headers %}
                <td>{{ row.get(header, '') }}</td>
                {% endfor %}
                <td class="center">
                    {% set id_val = (row.get('ID') or row.get('nombre_empresa')) if tipo == 'clientes' else
                    (row.get('folio') or row.get('nombre_empresa')) %}
                    <a href="{{ url_for('detalle_directorio', tipo=tipo, id_val=id_val) }}"
                        class="btn btn-secondary btn-small">Ver Detalle</a>
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="{{ headers|length + 1 }}" class="text-center text-muted p-8">No hay registros de {{ tipo
                    }}.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- Pagination -->
{% if total_pages > 1 %}
<div class="pagination" style="display: flex; justify-content: center; gap: 0.5rem; margin-top: 1rem;">
    {% if page > 1 %}
    <a href="{{ url_for('ver_directorio', tipo=tipo, page=page-1) }}" class="btn-page"
        style="padding: 0.25rem 0.5rem; border: 1px solid #ddd; text-decoration: none; color: #333;">&laquo;
        Anterior</a>
    {% endif %}

    <span style="font-size: 0.8rem; align-self: center;">Página {{ page }} de {{ total_pages }}</span>

    {% if page < total_pages %} <a href="{{ url_for('ver_directorio', tipo=tipo, page=page+1) }}" class="btn-page"
        style="padding: 0.25rem 0.5rem; border: 1px solid #ddd; text-decoration: none; color: #333;">Siguiente
        &raquo;</a>
        {% endif %}
</div>
{% endif %}
{% endblock %}